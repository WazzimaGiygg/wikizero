<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fórum Wiki Zone</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.indigo-pink.min.css">
    </head>
<body>
    <script>
        // Função para obter o UID da URL
        function getUidFromUrl() {
            const params = new URLSearchParams(window.location.search);
            return params.get('uid');
        }

        // Função para carregar os tópicos do fórum
        function loadForumContent() {
            const uid = getUidFromUrl(); // Obtém o UID da URL
            if (!uid) {
                // Se não houver UID, significa que o usuário não está logado ou houve um erro
                const forumContainer = document.getElementById('forum-content');
                forumContainer.innerHTML = '<p>Você precisa estar logado para ver o fórum.</p>';
                return;
            }

            fetch('https://api.exemplo.com/forum', {
                method: 'GET',
                headers: {
                    'X-Access-Key': '$2a$10$yYkleiX8VSZNdbcsN8o6iuVm56ZSSHYExMh.OZ8DW07Qx5B1OJpj6',
                    'X-master-key': '$2a$10$cEA4Da43tn/93eVxBkR.AufLM/ALUPxOgh8KskR1QvSLsUHzLyb4y'
                }
            })
            .then(response => response.json())
            .then(data => {
                displayForum(data, uid); // Passando o UID para associar com os tópicos
            })
            .catch(error => {
                console.error('Erro ao carregar os tópicos do fórum:', error);
                const forumContainer = document.getElementById('forum-content');
                forumContainer.innerHTML = '<p>Erro ao carregar o fórum. Tente novamente mais tarde.</p>';
            });
        }

        // Função para exibir os tópicos do fórum
        function displayForum(data, uid) {
            const forumContainer = document.getElementById('forum-content');
            forumContainer.innerHTML = ''; // Limpar conteúdo existente
            if (!data || !data.topics || data.topics.length === 0) {
                forumContainer.innerHTML = '<p>Nenhum tópico encontrado no fórum.</p>';
                return;
            }
            data.topics.forEach(topic => {
                const topicElement = document.createElement('div');
                topicElement.classList.add('forum-topic');
                topicElement.innerHTML = `
                    <h3>${topic.title}</h3>
                    <p>${topic.content}</p>
                    <small>Criado por: ${topic.author}</small>
                `;
                forumContainer.appendChild(topicElement);

                // Verificando se o tópico foi criado pelo usuário logado
                if (topic.authorUID === uid) {
                    const editButton = document.createElement('button');
                    editButton.innerText = 'Editar';
                    editButton.addEventListener('click', () => editTopic(topic.id));
                    topicElement.appendChild(editButton);
                }
            });
        }

        // Função para editar o tópico (apenas se o UID corresponder)
        function editTopic(topicId) {
            alert('Abrir formulário de edição para o tópico ' + topicId);
            // Implemente a lógica de edição aqui
        }

        // Chama a função para carregar o conteúdo do fórum ao carregar a página
        window.onload = function() {
            loadForumContent();
        };
    </script>

    <div id="forum-content" class="page-content">
        </div>

    </body>
</html>
